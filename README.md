# Проект: Веб-приложение для организации киберспортивных турниров

### Технологии:

-   **Backend**: Python + FastAPI
-   **Frontend**: React + Tailwind CSS + TypeScript + Vite
-   **База данных**: PostgreSQL
-   **ORM**: SQLAlchemy (есть условия использования)
-   **Дополнительные библиотеки**: Alembic (для миграций), JWT (для аутентификации), bcrypt (для хеширования паролей).

---

## Описание проекта:

Веб-приложение предназначено для управления киберспортивными турнирами. Система позволяет создавать турниры, управлять командами, организовывать расписание матчей, отображать сетку игр и отслеживать результаты.

---

## Основной функционал:

1. **Авторизация и управление пользователями**:

    - Регистрация и авторизация пользователей через логин и пароль.
    - Роли пользователей:
        - **Администратор** (создание турниров, управление пользователями).
        - **Организатор** (создание и настройка турниров, управление командами).
        - **Игрок** (участие в турнирах, управление своими командами).
    - Безопасное хранение паролей (хеширование с помощью bcrypt).

2. **Создание турниров**:

    - Организатор может создавать турнир с указанием:
        - Названия.
        - Типа турнира (одинарный/двойной элиминейшен, круговой).
        - Правил участия.
    - Возможность предварительной настройки: добавить правила, описание.

3. **Создание команд**:

    - Пользователи могут создавать команды, участвовать в турнирах.
    - Управление участниками команды (капитан добавляет/удаляет игроков).

4. **Сетка турниров**:

    - Генерация турнирной сетки на основе количества команд.
    - Возможность просмотра результатов матчей.

5. **Управление расписанием матчей**:

    - Планирование времени матчей.
    - Изменение расписания и уведомление участников.

6. **Архивирование данных**:
    - Администратор может создавать резервные копии базы данных.
    - Возможность восстановления данных через интерфейс.

---

## Архитектура базы данных (минимум 7 таблиц):

1. **Users**:

    - `id`: первичный ключ.
    - `username`: уникальный никнейм.
    - `hashed_password`: хешированный пароль.
    - `role`: роль пользователя.
    - `created_at`, `updated_at`.

2. **Tournaments**:

    - `id`: первичный ключ.
    - `name`: название турнира.
    - `type`: тип турнира (строка).
    - `rules`: текст правил.
    - `created_by`: внешний ключ на `Users`.
    - `created_at`, `updated_at`.

3. **Teams**:

    - `id`: первичный ключ.
    - `name`: название команды.
    - `captain_id`: внешний ключ на `Users` (капитан команды).
    - `created_at`, `updated_at`.

4. **Players**:

    - `id`: первичный ключ.
    - `user_id`: внешний ключ на `Users`.
    - `team_id`: внешний ключ на `Teams`.

5. **Matches**:

    - `id`: первичный ключ.
    - `tournament_id`: внешний ключ на `Tournaments`.
    - `team1_id`, `team2_id`: внешние ключи на `Teams`.
    - `score_team1`, `score_team2`: результаты матча.
    - `start_time`, `end_time`.

6. **Bracket**:

    - `id`: первичный ключ.
    - `tournament_id`: внешний ключ на `Tournaments`.
    - `match_id`: внешний ключ на `Matches`.
    - `round`: номер раунда.
    - `position`: позиция в сетке.

7. **Backup**:
    - `id`: первичный ключ.
    - `file_path`: путь к файлу резервной копии.
    - `created_by`: внешний ключ на `Users`.
    - `created_at`.

---

## Реализация:

### Backend:

-   **FastAPI**:

    -   Реализация всех API-эндпоинтов для CRUD операций.
    -   Асинхронная обработка запросов.
    -   Валидация входных данных через Pydantic.

-   **Функционал API**:

    -   Авторизация (JWT-токены).
    -   CRUD для пользователей, турниров, команд, матчей.
    -   Генерация и управление турнирной сеткой.

-   **Резервное копирование**:
    -   Скрипт для создания дампа базы данных (`pg_dump`).
    -   API для загрузки/восстановления архива.

### Frontend:

-   **React + Tailwind CSS**:
    -   Простая и интуитивно понятная структура страниц.
    -   Асинхронное взаимодействие с сервером через Axios/Fetch.
    -   Интерфейс для просмотра и управления турнирами, командами, сеткой.

---

## Требования к проекту:

1. Использовать СУБД PostgreSQL.
2. Минимум 7 таблиц в базе данных, приведенных к третьей нормальной форме (3NF).
3. Все запросы к базе данных должны формироваться вручную.
4. Допускается использование ORM только для передачи SQL-запросов через методы вроде `session.execute`.
5. Запрещено:
    - Формирование SQL-запросов на стороне клиента.
    - Использование UI-сред (DBeaver, pgAdmin, DataGrip) для проектирования базы данных.
6. База данных должна содержать представления (views), хранимые процедуры, триггеры и функции.
7. Структура базы данных должна быть инициализирована через SQL-скрипты.
8. Клиентское приложение должно быть веб-приложением.
9. Реализовать асинхронное взаимодействие между клиентом и сервером через REST API.
10. Пароли пользователей должны храниться в виде хэшей (например, bcrypt).
11. Обеспечить авторизацию пользователей с различными ролями (администратор, организатор, игрок) с разграничением прав доступа.
12. Вся бизнес-логика должна находиться на стороне backend.
13. Обеспечить корректную обработку ошибок на уровне базы данных, backend и клиентского приложения.
14. Реализовать резервное копирование базы данных и восстановление данных через клиентское приложение.
15. Все SQL-запросы должны быть строго параметризованными для предотвращения SQL-инъекций.
16. Реализовать функции для выполнения CRUD-операций для всех основных сущностей.
17. Предоставить понятный и удобный интерфейс клиентского приложения, обеспечивающий доступ ко всем функциям.
18. Графическое отображение данных, где это необходимо (например, турнирные сетки).
19. Обеспечить асинхронность работы системы для независимого взаимодействия разных пользователей.
20. Разработка SQL-запросов вручную.
21. Подключение ORM только для выполнения запросов, но не для автоматического маппинга классов на таблицы.

---

## План разработки:

1. Настройка окружения (FastAPI + PostgreSQL + React).
2. Проектирование базы данных и реализация моделей.
3. Создание базовых эндпоинтов (авторизация, турниры, команды).
4. Реализация турнирной сетки и расписания матчей.
5. Интеграция с фронтендом.
6. Тестирование и деплой.

---
